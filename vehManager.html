<!DOCTYPE html>
<!-- its better if i saparate it into different files but im just lazy to do so -->
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Veh Manager</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<style>
		html, body {
			height: 100%;
			width: 100%;
			margin: 0;

			font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    		letter-spacing: 0.25px;
			background-color: #333;
			color: #ddd;
		}

		body {
			padding: 3rem;
			box-sizing: border-box;
		}


		.hidden { display: none; visibility: hidden; }
		.section {
			margin-top: 1rem;
		}
		.panel {
			padding: 0.5rem 1rem;
			border-radius: 8px;
			background-color: #444;
		}
		.panel.highlight {
			border: 1px solid #666;
			box-shadow: 0 0 2px 0px #66666666, inset 0 0 2px #00000066;
		}

		.input {
			padding: 0.5rem 1rem;
			border-radius: 8px;
			background-color: rgba(128, 128, 128, 0.2);
			border: 0;
			color: #ddd;
		}
		.input:hover {
			background-color: rgba(128, 128, 128, 0.1);
		}
		.input[type="checkbox"] {
			padding: 0.5rem;
			border-radius: 6px;
			appearance: none;
		}
		.input[type="checkbox"]:checked {
			background-color: #66f;
		}
		.input:focus, .input:focus-visible, .input:focus-within,
		details[open] > summary.input {
			outline: 1px solid #66f;
			outline-offset: 0px;
		}

		
		#gta-folder-upload:not(.active) {
			padding: 1rem;
			border: 1px solid;
			border-radius: 1rem;
			text-align: center;

			margin-bottom: 1rem;
		}
		#gta-folder-upload.active {
			position: fixed;
			z-index: 1000;
			top: 3rem;
			left: 3rem;
			width: calc(100% - (2 * 3rem));
			height: calc(100% - (2 * 3rem));

			border-radius: 1rem;
			background-color: #222;
			outline: 0.25rem dashed #aaa;
			user-select: none;

			display: flex;
			justify-content: center;
			align-items: center;
			font-size: 42px;
			font-weight: 700;
			font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
		}

		table {
			width: 100%;
		}
		td, th {
			padding: 0.5rem;
			border-radius: 8px;
			background-color: rgba(128, 128, 128, 0.2);
		}
		tbody {
			font-family: monospace;
		}

		td.missing {
			background-color: rgba(128, 0, 0, 0.2);
		}
		td.selected {
			background-color: rgba(0, 128, 0, 0.2);
		}
		td.center {
			text-align: center;
		}

		.filter-option {
			display: flex;
			gap: 1rem;
			align-items: center;
			justify-content: space-between;
		}
		.filter-option > div {
			display: flex;
			gap: 0.5rem;
			background: rgba(0, 0, 0, 0.2);
			padding: 2px;
			border-radius: 6px;
		}
		.filter-option > div.icon-options > .fa-solid {
			/* background: rgba(128, 128, 128, 0.2); */
			padding: 1px 3px;
			text-align: center;
			min-width: 22.25px;
			border-radius: 4px;
			box-sizing: border-box;
		}
		.filter-option > div.icon-options > .fa-solid.active,
		.filter-option > div.icon-options > .fa-solid:hover {
			background-color: rgba(128, 128, 128, 0.2);
		}

		.popups {
			display: flex;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			justify-content: center;
			align-items: center;
			pointer-events: none;
		}
		.popup {
			display: flex;
			background: rgb(32, 32, 32);
			gap: 1rem;
			border-radius: 8px;
			padding: 1rem;
			flex-direction: column;
			width: 90%;
			height: 90%;
			pointer-events: all;
		}
		.popup:not(.active) {
			display: none;
		}

		.custom-select {
			position: relative;
			margin-top: 0.25rem;
		}
		.custom-select select {
			appearance: none;
			width: 100%;
			/* font-size: 1.15rem; */
			padding: 0.25rem 0.5rem;
			color: #fff;
			background: #363636;
			outline: none;
			border: 0;
			border-radius: 6px;
			cursor: pointer;
		}
		.custom-select::before,
		.custom-select::after {
			--size: 0.3rem;
			position: absolute;
			content: "";
			right: 0.5em;
			pointer-events: none;
		}

		.custom-select::before {
			border-left: var(--size) solid transparent;
			border-right: var(--size) solid transparent;
			border-bottom: var(--size) solid white;
			top: 0.4rem;
		}

		.custom-select::after {
			border-left: var(--size) solid transparent;
			border-right: var(--size) solid transparent;
			border-top: var(--size) solid white;
			bottom: 0.4rem;
		}
	</style>
</head>
<body>
	<div id="gta-folder-upload" class="active">Drag & Drop your gta folder here...</div>
	<div id="id-status"></div>


	<div class="section">
		<h3>Summary</h3>
		<div>
			<details style="position: relative;">
				<summary class="input" style="list-style: none;color: rgb(200,100,100);">
					<i class="fa-solid fa-triangle-exclamation"></i>
					<span style="font-weight: 600;" id="summary-errors-count">Errors</span>
				</summary>

				<div class="panel" style="margin-top: 0.5rem;">
					<span id="summary-errors">No Errors</span>
				</div>
			</details>
		</div>
	</div>
	<div class="section">
		<h3>Actions</h3>
		<div>
			<button class="input" onclick="generateCheatMenu()" title="generates a file that makes custom vehicles show up in cheat menu">Generate Cheat Menu</button>
			<button class="input" onclick="generateVehiclesTest()" title="generates info needed for vehicle test mod to load all custom vehicles">Generate Vehicles Test</button>
			<button class="input" onclick="vehiclesOrgenizer()" title="Orgenizes vehicle lines by line type; ide, dat, etc.">Vehicles Orgenizer</button>
			<button class="input" onclick="modifyVehiclesIds()" title="Changes a list of vehicles ids to another range">Modify Vehicles Ids</button>
			<button class="input" onclick="vehiclesSeparator()" title="Saparates existing vehicles from new ones">Vehicles Separator</button>
			<button class="input" onclick="modifyVehiclesName()" title="Changes names for a list of vehicles using regex">Modify Vehicles Names</button>
		</div>
	</div>
	<div class="section">
		<div style="display: flex;align-items: center;justify-content: space-between;">
			<h3 style="margin-top: 0;">Experimental View</h3>
			<div>
				<button class="input" onclick="viewer3DNext(true)">&lt;</button>
				<button class="input" onclick="viewer3DNext(false)">&gt;</button>
			</div>
		</div>
		<div style="display: flex;justify-content: center;width: 100%;height:100%">
			<table id="def-colors" style="width: fit-content;height: fit-content;">
			  <!-- JS inserts colors here -->
			</table>
			<canvas id="glcanvas" width="650" height="480" style="border-radius: 8px;"></canvas>
			<table id="colors" style="width: fit-content;height: fit-content;min-width: 70px;">
			  <!-- JS inserts colors here -->
			</table>
		</div>
	</div>
	<div class="section">
		<h3>Filters</h3>
		<div style="display: flex;gap: 0.25rem;">
			<input id="veh-search" class="input" placeholder="Search..." oninput="updateSearch()" style="flex-grow: 1;">
			<details style="position: relative;">
				<summary class="input" style="list-style: none;">
					<i class="fa-solid fa-filter"></i>
				</summary>

				<div class="panel highlight" style="position: absolute;right: 0;margin-top: 0.5rem;width: max-content;">
					<div class="filter-option" filter-type="select" filter-for="VehEnabled">
						<span>Vehicle Enabled</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-check"></i>
							<i class="fa-solid fa-minus active"></i>
							<i class="fa-solid fa-xmark"></i>
						</div>
					</div>
					<div class="filter-option" filter-type="select" filter-for="SummaryType">
						<span>Summary Type</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-triangle-exclamation" style="color: rgb(200,100,100);"></i>
							<i class="fa-solid fa-triangle-exclamation" style="color: rgb(200,200,100);"></i>
							<i class="fa-solid fa-minus active"></i>
						</div>
					</div>
					<div class="filter-option" filter-type="select" filter-for="CustomVeh">
						<span>Custom Vehicle</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-check"></i>
							<i class="fa-solid fa-minus active"></i>
							<i class="fa-solid fa-xmark"></i>
						</div>
					</div>
					<div class="filter-option" filter-type="select" filter-for="Audio">
						<span>Has Audio</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-check"></i>
							<i class="fa-solid fa-minus active"></i>
							<i class="fa-solid fa-xmark"></i>
						</div>
					</div>
					<div class="filter-option" filter-type="select" filter-for="Tuning">
						<span>Has tuning</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-check"></i>
							<i class="fa-solid fa-minus active"></i>
							<i class="fa-solid fa-xmark"></i>
						</div>
					</div>
					<div class="filter-option" filter-type="select" filter-for="HasColors">
						<span>Has Colors</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-check"></i>
							<i class="fa-solid fa-minus active"></i>
							<i class="fa-solid fa-xmark"></i>
						</div>
					</div>
					<div class="filter-option" filter-type="select" filter-for="HasHandling">
						<span>Has Handling</span>
						<div class="icon-options" filter-select>
							<i class="fa-solid fa-check"></i>
							<i class="fa-solid fa-minus active"></i>
							<i class="fa-solid fa-xmark"></i>
						</div>
					</div>
					<div class="filter-option custom-select" filter-type="input" filter-for="VehType">
						<select value="any" filter-select>
							<option value="any">Any Vehicle Type</option>
							<option value="car">Car</option>
							<option value="mtruck">Monster Truck</option>
							<option value="heli">Helicopter</option>
							<option value="boat">Boat</option>
							<option value="trailer">Trailer</option>
							<option value="bike">Motorbike</option>
							<option value="quad">Quad Bike</option>
							<option value="bmx">BMX Bike</option>
							<option value="train">Train</option>
							<option value="plane">Plane</option>
						</select>
					</div>
					<div class="filter-option custom-select" filter-type="input" filter-for="ClassType">
						<select value="any" filter-select>
							<option value="any">Any Vehicle Class</option>
							<option value="normal">Normal</option>
							<option value="poorfamily">Poor Family</option>
							<option value="executive">Executive</option>
							<option value="worker">Worker</option>
							<option value="richfamily">Rich Family</option>
							<option value="ignore">Ignore</option>
							<option value="taxi">Taxi</option>
							<option value="big">Big</option>
							<option value="leisureboat">Leisure Boat</option>
							<option value="workerboat">Worker Boat</option>
							<option value="motorbike">Motorbike</option>
							<option value="moped">Moped</option>
							<option value="bicycle">Bicycle</option>
						</select>
					</div>
				</div>
			</details>
			<!-- filters -->
				<!-- with errors -->
				<!-- missing files -->
				<!-- missing lines -->
				<!-- ids enabled: yes/natural/no -->
				<!-- has tuning: yes/natural/no -->
		</div>
	</div>
	<table class="section" id="id-table"></table>

	<div class="popups">
		<div class="popup" id="cheatmenu-popup">
			<span>Copy and paste in 'CheatMenuSA\data\vehicles.toml'</span>
			<textarea class="input" id="cheatmenu-vehicles" style="height: 100%;">...</textarea>
			<button class="input" onclick="this.parentElement.classList.remove('active');">close</button>
		</div>
		<div class="popup" id="vehiclestest-popup">
			<span>Copy and paste in 'cleo\Vehicles Test.ini'<br>keep everything until 'IDend = xxx' and replace whats after it.</span>
			<textarea class="input" id="vehiclestest-vehicles" style="height: 100%;">...</textarea>
			<button class="input" onclick="this.parentElement.classList.remove('active');">close</button>
		</div>
		<div class="popup" id="modifyids-popup">
			<span>Paste your vehicles ide list</span>
			<input class="input" id="modifyids-startindex" type="number" value="19999">
			<label style="display: flex;gap: 0.25rem;"><input id="modifyids-skipexistingids" class="input" type="checkbox" checked> Skip existing ids</label>
			<textarea class="input" id="modifyids-vehicles" style="height: 100%;"></textarea>
			<button class="input" onclick="this.parentElement.classList.remove('active');">close</button>
		</div>
		<div class="popup" id="modifynames-popup">
			<span>Paste your vehicles ide list and spesify regex and replace fields<br>this only modifies name and txd</span>
			<input class="input" id="modifynames-from" placeholder="from...">
			<input class="input" id="modifynames-to" placeholder="to...">
			<button class="input" id="modifynames-update">Update</button>
			<textarea class="input" id="modifynames-vehicles" style="height: 100%;"></textarea>
			<button class="input" onclick="this.parentElement.classList.remove('active');">close</button>
		</div>
		<div class="popup" id="vehiclesepartor-popup">
			<span>Paste your vehicles ide list on the left<br>it will move existing ones to the right</span>
			<button class="input" id="vehiclesepartor-update">Update</button>
			<div style="display: flex;height: 100%;gap: 1rem;">
				<textarea class="input" id="vehiclesepartor-vehicles" style="width: 100%;"></textarea>
				<textarea class="input" id="vehiclesepartor-existing" style="width: 100%;" readonly></textarea>
			</div>
			<button class="input" onclick="this.parentElement.classList.remove('active');">close</button>
		</div>
		<div class="popup" id="vehicleorgenizer-popup">
			<span>Paste your vehicles lines list on the left<br>it will categorize them into the right</span>
			<button class="input" id="vehicleorgenizer-update">Update</button>
			<div style="display: flex;height: 100%;gap: 1rem;">
				<textarea class="input" id="vehicleorgenizer-vehicles" style="width: 100%;"></textarea>
				<textarea class="input" id="vehicleorgenizer-existing" style="width: 100%;"></textarea>
			</div>
			<button class="input" onclick="this.parentElement.classList.remove('active');">close</button>
		</div>
	</div>

	<script src="./vehviewer/gl-matrix.js"></script>
	<script src="./vehviewer/gl-util.js"></script>
	<script src="./vehviewer/rw.js"></script>
	<script src="./vehviewer/rwrender.js"></script>
	<script src="./vehviewer/shaders.js"></script>
	<script src="./vehviewer/rwstream.js"></script>
	<script src="./vehviewer/main.js"></script>
	<script src="./vehviewer/loaddata.js"></script>
	<script>
		"use strict";
		InitRW();
		const folderUpload = document.getElementById("gta-folder-upload");
		const idStatus = document.getElementById("id-status");
		const idTable = document.getElementById("id-table");
		const searchbox = document.getElementById("veh-search");

		const gameGxt = "LANDSTK Landstalker\nBRAVURA Bravura\nBUFFALO Buffalo\nLINERUN Linerunner\nPEREN Perennial\nSENTINL Sentinel\nINFERNU Infernus\nDUMPER Dumper\nFIRETRK Fire Truck\nTRASHM Trashmaster\nSTRETCH Stretch\nMANANA Manana\nVOODOO Voodoo\nPONY Pony\nMULE Mule\nCHEETAH Cheetah\nAMBULAN Ambulance\nLEVIATH Leviathan\nHUNTER Hunter\nMOONBM Moonbeam\nESPERAN Esperanto\nTAXI Taxi\nWASHING Washington\nBOBCAT Bobcat\nWHOOPEE Mr. Whoopee\nBFINJC BF Injection\nPOLICAR Police\nENFORCR Enforcer\nSECURI Securicar\nBANSHEE Banshee\nPREDATR Predator\nBUS Bus\nRHINO Rhino\nBARRCKS Barracks\nHOTKNIF Hotknife\nHELI Chopper\nPREVION Previon\nCOACH Coach\nCABBIE Cabbie\nSTALION Stallion\nRUMPO Rumpo\nRCBANDT RC Bandit\nROMERO Romero\nPACKER Packer\nMONSTER Monster\nADMIRAL Admiral\nSQUALO Squalo\nSEASPAR Seasparrow\nPIZZABO Pizzaboy\nTRAM Tram\nAEROPL Air Train\nDODO Dodo\nSPEEDER Speeder\nREEFER Reefer\nTROPIC Tropic\nFLATBED Flatbed\nYANKEE Yankee\nCADDY Caddy\nSOLAIR Solair\nTOPFUN Berkley's RC Van\nSKIMMER Skimmer\nPCJ600 PCJ-600\nFAGGIO Faggio\nFREEWAY Freeway\nRCBARON RC Baron\nRCRAIDE RC Raider\nGLENDAL Glendale\nOCEANIC Oceanic\nSANCHEZ Sanchez\nSPARROW Sparrow\nPATRIOT Patriot\nQUAD Quadbike\nCOASTG Coastguard\nDINGHY Dinghy\nHERMES Hermes\nSABRE Sabre\nMUSTANG Mustang\nZR350 ZR-350\nWALTON Walton\nREGINA Regina\nCOMET Comet\nBMX BMX\nBURRITO Burrito\nCAMPER Camper\nMARQUIS Marquis\nBAGGAGE Baggage\nDOZER Dozer\nMAVERIC Maverick\nSANMAV News Chopper\nRANCHER Rancher\nFBIRANC FBI Rancher\nVIRGO Virgo\nGREENWO Greenwood\nJETMAX Jetmax\nHOTRING Hotring Racer\nSANDKIN Sandking\nBLISTAC Blista Compact\nPOLMAV Police Maverick\nBOXBURG Boxville\nBOXVILL Boxville\nBENSON Benson\nMESAA Mesa\nRCGOBLI RC Goblin\nHOTRINA Hotring Racer\nHOTRINB Hotring Racer\nBLOODRA Bloodring Banger\nBLOODRB Bloodring Banger\nSUPERGT Super GT\nELEGANT Elegant\nJOURNEY Journey\nBIKE Bike\nMTBIKE Mountain Bike\nBEAGLE Beagle\nCROPDST Cropduster\nSTUNT Stuntplane\nPETROL Tanker\nRDTRAIN Roadtrain\nNEBULA Nebula\nMAJESTC Majestic\nBUCCANE Buccaneer\nLEARJET Learjet\nHARRIER Harrier\nFCR900 FCR-900\nNRG500 NRG-500\nHPV1000 HPV1000\nCEMENT Cement Truck\nTOWTRUK Towtruck\nFORTUNE Fortune\nCADRONA Cadrona\nFBITRUK FBI Truck\nWILLARD Willard\nFORKLFT Forklift\nTRACTOR Tractor\nCOMBINE Combine Harvester\nFELTZER Feltzer\nREMING Remington\nSLAMVAN Slamvan\nBLADE Blade\nFREIGHT Freight\nSTREAK Brown Streak\nVORTEX Vortex\nVINCENT Vincent\nBULLET Bullet\nCLOVER Clover\nSADLER Sadler\nRANGER Ranger\nHUSTLER Hustler\nINTRUDR Intruder\nPRIMO Primo\nCARGOBB Cargobob\nTAMPA Tampa\nSUNRISE Sunrise\nMERIT Merit\nUTILITY Utility Van\nNEVADA Nevada\nYOSEMIT Yosemite\nWINDSOR Windsor\nMONSTA Monster\nMONSTB Monster\nURANUS Uranus\nJESTER Jester\nSULTAN Sultan\nFLAME Flame\nSTRATUM Stratum\nELEGY Elegy\nRAINDNC Raindance\nRCTIGER RC Tiger\nFLASH Flash\nTAHOMA Tahoma\nSAVANNA Savanna\nBANDITO Bandito\nFRFLAT Freight\nSTREAKC Brown Streak\nKART Kart\nMOWER Mower\nDUNE Dune\nSWEEPER Sweeper\nBROADWY Broadway\nTORNADO Tornado\nAT400 AT-400\nDFT30 DFT-30\nHUNTLEY Huntley\nSTAFFRD Stafford\nBF400 BF-400\nNEWSVAN Newsvan\nTUG Tug\nPETROTR Petrol Truck\nEMPEROR Emperor\nWAYFARE Wayfarer\nFLOAT1 Float\nHOTDOG Hotdog\nCLUB Club\nFREIBOX Freight Box\nROLLER Roller\nANDROM Andromada\nRCCAM RC Cam\nLAUNCH Launch\nTURISMO Turismo\nPICADOR Picador\nSWATVAN S.W.A.T.\nALPHA Alpha\nPHOENIX Phoenix\nGLENSHI Glendale\nEUROS Euros\nPREMIER Premier\nRUSTLER Rustler\nSHAMAL Shamal\nHYDRA Hydra\nFIRELA Fire Truck\nSADLSHI Sadler\n";
		const ideFormatRX = /^(\d+)(?:,| |\t)(?: |\t)*(\S+)(?:,| |\t)(?: |\t)*(\S+)(?:,| |\t)/gm;
		const vehicleIdeRx = /^#?(\d+),?\s*(\S+),?\s*(\S+),?\s*(car|mtruck|quad|heli|f_heli|plane|f_plane|boat|train|bike|bmx|trailer),?\s*(\S+),?\s*(\S+),?\s*(\S+),?\s*(normal|special|poorfamily|richfamily|executive|worker|big|taxi|moped|motorbike|leisureboat|workerboat|bicycle|ignore),?\s*\d+,?\s*\d+,?\s*(\d+x*\d*f*\d*f*\d*),?(?:\t| )*(-?\d+)?,?(?:\t| )*(\d+\.?\d*)?,?(?:\t| )*(\d+\.?\d*)?,?(?:\t| )*(-?\d+)?(?:\t| )*$/gm;
		const handlingRx = /^([a-zA-Z0-9_]+)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(-?\d+\.?\d*)(?:\t| )+(-?\d+\.?\d*)(?:\t| )+(-?\d+\.?\d*)(?:\t| )+(\d+)(?:\t| )+(-?\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+([0-9A-Z])(?:\t| )+([0-9A-Z])(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+([0-9A-Z])(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(-?\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+(\d+\.?\d*)(?:\t| )+([0-9A-fa-f]+)(?:\t| )+([0-9A-fa-f]+)(?:\t| )+([0-9A-Z])(?:\t| )+([0-9A-Z])(?:\t| )+(\d+)(?:\t| )*$/gm;
		const fxtFormatRX = /^([a-zA-Z0-9]+) (.+)$/gm;
		const vehicleAudioRX = /^([0-9a-zA-Z_]+)(?: |\t)+(\d+)(?: |\t)+(-?\d+)(?: |\t)+(-?\d+)(?: |\t)+(\d+)(?: |\t)+(\d+\.?\d*)(?: |\t)+(\d+\.?\d*)(?: |\t)+(-?\d+)(?: |\t)+(\d+\.?\d*)(?: |\t)+(-?\d+)(?: |\t)+(\d+)(?: |\t)+(\d+)(?: |\t)+(-?\d+)(?: |\t)+(-?\d+)(?: |\t)+(\d+\.?\d*)(?: |\t)*$/gm;
		const carcolsRX = /^(\w+),\s*((?:(?: |\t|,)*\d+)+),?(?: |\t)*$/gm;
		const carmodsRX = /^(\w+),?(?:(?:,| |\t)+(?:hydralics|stereo|nto_\w+|bnt_\w+|chss_\w+|exh_\w+|bntl_\w+|bntr_\w+|spl_\w+|wg_l_\w+|wg_r_\w+|fbb_\w+|bbb_\w+|lgt_\w+|rf_\w+|fbmp_\w+|rbmp_\w+|misc_a_\w+|misc_b_\w+|misc_c_\w+))+(?: |\t)*$/gm;
		const carmodsUpgrades = ["nto_","bnt_","chss_","exh_","bntl_","bntr_","spl_","wg_l_","wg_r_","fbb_","bbb_","lgt_","rf_","fbmp_","rbmp_","misc_a_","misc_b_","misc_c_"]
		const vehicleTypeIcons = {
			car: `<i class="fa-solid fa-car-side"></i>`,
			mtruck: `<i class="fa-solid fa-truck-monster"></i>`,
			heli: `<i class="fa-solid fa-helicopter"></i>`,
			boat: `<i class="fa-solid fa-sailboat"></i>`,
			trailer: `<i class="fa-solid fa-trailer"></i>`,
			bike: `<i class="fa-solid fa-bicycle"></i>`,
			quad: `<i class="fa-solid fa-bicycle"></i>`,
			bmx: `<i class="fa-solid fa-bicycle"></i>`,
			train: `<i class="fa-solid fa-train"></i>`,
			plane: `<i class="fa-solid fa-plane"></i>`,
		}


		/** @typedef {{
		 * id: number;
		 * type: "car"|"mtruck"|"heli"|"boat"|"trailer"|"bike"|"quad"|"bmx"|"train"|"plane";
		 * name: string;
		 * gameName: string;
		 * isDisabled: boolean;
		 * isDefault: boolean;
		 * fxtTag: string;
		 * handlingTag: string;
		 * vehicleClass: string;
		 * lines: {
		 * 		ide: string;
		 * 		handling: string;
		 * 		audio: string;
		 * 		carmods: string;
		 * 		carcols: string;
		 * };
		 * filePaths: {
		 * 		ide: string;
		 * 		dff: string;
		 * 		txd: string;
		 * 		handling: string;
		 * 		carmods: string;
		 * 		carcols: string;
		 * 		fxt: string;
		 * };
		 * summary: {
		 * 		errors: string[];
		 * 		warnings: string[];
		 * };
		 * }} Vehicle */
		const VehicleUpdate = {
			tags() {
				vehiclesList.filter(veh => veh.gameName == null).forEach(veh => {
					let fxtData = fxtTags[veh.fxtTag];
					if (!fxtData) return;

					veh.gameName = fxtData.text;
					veh.filePaths.fxt = fxtData.fullPath;
				});
			},
			handlings() {
				vehiclesList.filter(veh => veh.lines.handling == null).forEach(veh => {
					let handlingLine = handlingTags[veh.handlingTag];
					if (!handlingLine) return;

					veh.lines.handling = handlingLine.line;
					veh.filePaths.handling = handlingLine.fullPath;
				});
			},
			carcols() {
				vehiclesList.filter(veh => veh.lines.carcols == null).forEach(veh => {
					let carcolsLine = carcolsLines[veh.name];
					if (!carcolsLine) return;

					veh.lines.carcols = carcolsLine.line;
					veh.filePaths.carcols = carcolsLine.fullPath;
				});
			},
			carmods() {
				vehiclesList.filter(veh => veh.lines.carmods == null).forEach(veh => {
					let carmodsLine = carmodsLines[veh.name];
					if (!carmodsLine) return;

					veh.lines.carmods = carmodsLine.line;
					veh.filePaths.carmods = carmodsLine.fullPath;
				});
			},
			audio() {
				vehiclesList.filter(veh => veh.lines.audio == null).forEach(veh => {
					let audioLine = vehicleAudio[veh.name];
					if (!audioLine) return;

					veh.lines.audio = audioLine;
				});
			},
		};

		/** @type {Vehicle[]} */
		let vehiclesList = [];

		let fileCount = 0;
		let filesLoading = 0;
		let files = {};

		let ideFiles = [];
		let handlingFiles = [];
		let carcolsFiles = [];
		let carmodsFiles = [];
		let fxtFiles = [];
		let fastman92AudioFile = null;

		let handlingTags = {};
		let fxtTags = {};
		let vehicleAudio = {};
		let carcolsLines = {};
		let carmodsLines = {};

		/**
		 * @type {{
		 * 		id: Number;
		 * 		name: String;
		 * 		fullPath: String;
		 * }[]}
		*/
		let idList = [];
		let filters = {
			VehEnabled: 1,
			SummaryType: 2,
			CustomVeh: 1,
			Audio: 1,
			Tuning: 1,
			HasColors: 1,
			HasHandling: 1,
			ClassType: "any",
			VehType: "any",
		};
		let summary = {
			//errors
			MissingDFF: [],
			MissingTXD: [],
			MissingHandling: [],
			ExtraAudio: [],
			ExtraCarCols: [],
			ExtraCarMods: [],
		};
		const iconsHTML = {
			check: '<i class="fa-solid fa-check"></i>',
			cross: '<i class="fa-solid fa-xmark"></i>',
			minus: '<i class="fa-solid fa-minus"></i>',
			error: '<i class="fa-solid fa-triangle-exclamation"></i>',
			info: '<i class="fa-solid fa-info"></i>',
		}

		//load gxt file as fxt format (manual process)
		gameGxt.match(fxtFormatRX).forEach(line => {
			let tag = line.split(" ")[0];
			let text = line.split(" ").slice(1).join(" ").trim();

			fxtTags[tag] = {
				text,
				fullPath: "text/american.gxt", // american.gxt if english
			};
		});

		//console header
		console.log("this project was made for personal use. its rushed out and not professionally written. the purpose of releasing this tool is to allow others to benifet from it too, you are free to copy, modify this tool just don't lock it behind a paywall. its made to help people and it has helped me a lot so i hope it helps you too.")

		//area where it would detect game files being dropped
		let dropArea = document;
		dropArea.addEventListener("dragover", function(event) {
			event.preventDefault();
    		event.stopPropagation();
		});
		dropArea.addEventListener("drop", async function(event) {
			event.preventDefault();

			var items = event.dataTransfer.items;
			if (items.length == 0) return;

			let spawnedThreads = [];
			for (var i=0; i<items.length; i++) {
				var item = items[i].webkitGetAsEntry();
				if (!item) continue;

				if (item.isFile) fileCount++;
				spawnedThreads.push(traverseFileTree(item));
			}

			Promise.all(spawnedThreads).then(() => {
				updateFilesToIdList();
			});
		}, false);


		//filter options
		document.querySelectorAll(`.filter-option[filter-type="select"]`).forEach((filterElement) => {
			let filterFor = filterElement.getAttribute("filter-for");
			let filterOptions = filterElement.querySelectorAll("[filter-select] > *");
			if (filters[filterFor] == null) return console.error("filter not exist", filterFor);

			const updateOptions = (firstTime = false) => {
				filterOptions.forEach((optionElement, optionIndex) => {
					if (filters[filterFor] == optionIndex) optionElement.classList.add("active");
					else optionElement.classList.remove("active");

					if (!firstTime) return;
					optionElement.addEventListener("click", () => {
						filters[filterFor] = optionIndex;

						updateOptions();
					});
				});

				//update list
				updateVisibleList();
			};

			updateOptions(true);
		});
		document.querySelectorAll(`.filter-option[filter-type="input"]`).forEach((filterElement) => {
			let filterFor = filterElement.getAttribute("filter-for");
			let filterInput = filterElement.querySelector("[filter-select]");
			if (filters[filterFor] == null) return console.error("filter not exist", filterFor);

			filterInput.addEventListener("change", () => {
				filters[filterFor] = filterInput.value;

				//update list
				updateVisibleList();
			});
		});


		/**
		 * @param {FileSystemEntry} item
		 * @param {String} path
		*/
		async function traverseFileTree(_item, path) {
			path = path || "";
			if (_item.isFile == _item.isDirectory) {
				throw Error("weird file: "+path+" "+item.name);
			}

			if (_item.isFile) {
				/** @type {FileSystemFileEntry} */
				let item = _item;

				// Get file
				item.file(function(file) {
					// console.log(path, "File:", path + file.name, file);
					addFileToFilesList(path, file);
				});
				return new Promise((resolve, reject) => {resolve()});
			}

			/** @type {FileSystemDirectoryEntry} */
			let item = _item;

			// Get folder contents
			var dirReader = item.createReader();
			const enteriesReader = async () => {
				await new Promise((resolve, reject) => {
					dirReader.readEntries(async function(entries) {
						fileCount += entries.filter((x) => x.isFile).length;

						let isGameFolder = entries.find((x) => x.name.toLowerCase() == "vorbis.dll" && x.isFile) != null;
						let itemName = item.name + "/";
						if (isGameFolder) itemName = "";
						// console.log(item, path, isGameFolder);

						for (var i=0; i < entries.length; i++) {
							traverseFileTree(entries[i], path + itemName);
						}

						//reads 100 more
						if (entries.length >= 99) await enteriesReader();

						resolve();
					});
				});
			};
			return enteriesReader();
		}
		
		/**
		 * @param {string} path
		 * @param {File} file
		*/
		async function addFileToFilesList(path, file) {
			let newFile = {
				name: file.name,
				path,
				fullPath: path+file.name,
				file,
			};
			files[newFile.fullPath] = newFile;

			// ide file
			if (file.name.toLowerCase().endsWith(".ide")) checkFileIde(newFile);
			if (path.toLowerCase().startsWith("modloader/") && file.name.toLowerCase().endsWith(".txt")) checkFileIde(newFile);

			// audio file
			if (file.name == "gtasa_vehicleAudioSettings.cfg") checkFileVehAudio(newFile);

			// fxt file
			if (file.name.toLowerCase().endsWith(".fxt")) checkFileFxt(newFile);

			// handling file
			if (file.name.toLowerCase() == "handling.cfg") checkFileHanding(newFile);
			if (path.toLowerCase().startsWith("modloader/") && file.name.toLowerCase().endsWith(".txt")) checkFileHanding(newFile);

			// carcols file
			if (file.name.toLowerCase() == "carcols.dat") checkFileCarcols(newFile);
			if (path.toLowerCase().startsWith("modloader/") && file.name.toLowerCase().endsWith(".txt")) checkFileCarcols(newFile);

			// carmods file
			if (file.name.toLowerCase() == "carmods.dat") checkFileCarMods(newFile);
			if (path.toLowerCase().startsWith("modloader/") && file.name.toLowerCase().endsWith(".txt")) checkFileCarMods(newFile);
		}

		async function waitFileObjLoad(fileObj) {
			if (fileObj.text instanceof Promise) await fileObj.text;
			if (fileObj.isLoaded == true) return;
			fileObj.text = fileObj.file.text();

			filesLoading++;
			await fileObj.text
			.then(x => {
				fileObj.text = x;
				fileObj.isLoaded = true;
				filesLoading--;
			})
			//.then(updateFilesToIdList);
		}

		async function checkFileIde(fileObj) {
			await waitFileObjLoad(fileObj);

			//register id in idList
			if (ideFormatRX.test(fileObj.text)) {
				fileObj.text.match(ideFormatRX).forEach(idLine => {
					let idLineComponents = idLine.split(ideFormatRX).slice(1,-1);
					if (idLineComponents[0] == '00') return;

					let id = parseInt(idLineComponents[0]);
					let name = idLineComponents[1];

					if (name.endsWith(",")) name = name.slice(0, -1);
					if (!isNaN(parseFloat(name)) && (parseFloat(name)+"") == name) return;

					let idConflicts = idList.filter(x => x.id == id && x.name != name && (id < 16700 || id > 16708));
					if (idConflicts.length > 0) idConflicts.map(x => console.log(x.id+": "+x.name+" to "+name+"\n"+x.fullPath+"\n"+fileObj.fullPath));

					idList.push({
						id,
						name,
						fullPath: fileObj.fullPath,
					})
				});
			}

			let hasVehicle = vehicleIdeRx.test(fileObj.text);
			if (!hasVehicle) return;

			ideFiles.push(fileObj.fullPath);

			fileObj.text.match(vehicleIdeRx).forEach(vehicleLine => {
				let vehicleDetails = vehicleLine.split(vehicleIdeRx).slice(1,-1);
				let vehicleId = parseInt(vehicleDetails[0]);
				let vehicleName = vehicleDetails[1];
				if (vehicleName.endsWith(",")) vehicleName = vehicleName.slice(0, -1);

				let registeredVehicle = vehiclesList.find(veh =>
					(veh.id == vehicleId && veh.name != vehicleName) || //id conflict
					(veh.id != vehicleId && veh.name == vehicleName) 	//same model twice
				);
				if (registeredVehicle) {
					console.warn(`CONFLICT: ${vehicleId} ${vehicleName}.\n${fileObj.fullPath}\n${registeredVehicle.filePaths.ide}`);
					return;
				}

				//already exists (same id and same name)
				if (vehiclesList.find(veh => veh.id == vehicleId) != null) {
					registeredVehicle = vehiclesList.find(veh => veh.id == vehicleId);
					registeredVehicle.hasDuplicate = true;
					console.info(`double definition: ${vehicleId} ${vehicleName}.\n${fileObj.fullPath}\n${registeredVehicle.filePaths.ide}`);
					return;
				}

				let fxtTag = vehicleDetails[5];
				if (fxtTag.endsWith(",")) fxtTag = fxtTag.slice(0, -1);
				
				let handlingTag = vehicleDetails[4];
				if (handlingTag.endsWith(",")) handlingTag = handlingTag.slice(0, -1);

				/**
				 * @type {Vehicle}
				*/
				let newVehicle = {
					id: vehicleId,
					type: vehicleDetails[3],
					name: vehicleName,
					gameName: fxtTags[fxtTag]?.text,
					isDisabled: vehicleLine.startsWith("#"),
					isDefault: vehicleId >= 400 && vehicleId <= 611,
					fxtTag,
					handlingTag,
					vehicleClass: vehicleDetails[7],
					lines: {
						ide: vehicleLine,
						handling: handlingTags[handlingTag]?.line,
						audio: vehicleAudio[vehicleName],
						carcols: carcolsLines[vehicleName]?.line,
						carmods: carmodsLines[vehicleName]?.line,
					},
					filePaths: {
						ide: fileObj.fullPath,
						fxt: fxtTags[fxtTag]?.fullPath,
						handling: handlingTags[handlingTag]?.fullPath,
						carcols: carcolsLines[vehicleName]?.fullPath,
						carmods: carmodsLines[vehicleName]?.fullPath,
					},
					summary: {
						errors: [],
						warnings: [],
					}
				};

				vehiclesList.push(newVehicle);
			});
		}
		async function checkFileFxt(fileObj) {
			await waitFileObjLoad(fileObj);

			if (fxtFormatRX.test(fileObj.text) != true) return;
			fxtFiles.push(fileObj.fullPath);

			fileObj.text.match(fxtFormatRX).forEach(line => {
				let tag = line.split(" ")[0];
				let text = line.split(" ").slice(1).join(" ").trim();

				if (fxtTags[tag] != null) {
					console.warn(`FXT: tag ${tag} renaming from ${fxtTags[tag].text} to ${text}.\n${fxtTags[tag].fullPath}\n${fileObj.fullPath}`);
				}

				fxtTags[tag] = {
					text,
					fullPath: fileObj.fullPath,
				};
			});

			//update vehicles tag
			VehicleUpdate.tags();
		}
		async function checkFileHanding(fileObj) {
			await waitFileObjLoad(fileObj);

			if (handlingRx.test(fileObj.text) != true) return;
			handlingFiles.push(fileObj.fullPath);

			fileObj.text.match(handlingRx).forEach(line => {
				let tag = line.split(" ")[0].split("\t")[0];

				if (handlingTags[tag] != null && handlingTags[tag].line !== line) {
					console.warn(`HANDLING: replacing ${tag}.\n${handlingTags[tag].fullPath}\n${fileObj.fullPath}`);
				}

				handlingTags[tag] = {
					line,
					fullPath: fileObj.fullPath,
				};
			});

			//update vehicles tag
			VehicleUpdate.handlings();
		}
		async function checkFileCarcols(fileObj) {
			await waitFileObjLoad(fileObj);

			if (carcolsRX.test(fileObj.text) != true) return;
			if (fileObj.name.toLowerCase() == "carcols.dat") {
				VehicleColours = [];
				LoadSectionedFile(fileObj.text, {
					col: LoadColour
				})
			}
			carcolsFiles.push(fileObj.fullPath);

			fileObj.text.match(carcolsRX).forEach(line => {
				let vehicleName = line.split(" ")[0].split("\t")[0].split(",")[0];
				if (vehicleName == "DK22Pac") return;

				if (carcolsLines[vehicleName] != null && carcolsLines[vehicleName].line !== line) {
					console.warn(`CARCOLS: replacing ${vehicleName}.\n${carcolsLines[vehicleName].fullPath}\n${fileObj.fullPath}`);
				}

				carcolsLines[vehicleName] = {
					line,
					fullPath: fileObj.fullPath,
				};
			});

			//update vehicles tag
			VehicleUpdate.carcols();
		}
		async function checkFileCarMods(fileObj) {
			await waitFileObjLoad(fileObj);

			if (carmodsRX.test(fileObj.text) != true) return;
			carmodsFiles.push(fileObj.fullPath);

			fileObj.text.match(carmodsRX).forEach(line => {
				let vehicleName = line.split(" ")[0].split("\t")[0].split(",")[0];

				for (let upgradeIndex = 0; upgradeIndex < carmodsUpgrades.length; upgradeIndex++) {
					const upgrade = carmodsUpgrades[upgradeIndex];
					if (vehicleName.startsWith(upgrade)) return;
				}

				if (carmodsLines[vehicleName] != null &&
					carmodsLines[vehicleName].line.trim() != line.trim()
				) {
					console.warn(`CARMODS: replacing ${vehicleName}.\n${carmodsLines[vehicleName].fullPath}\n${fileObj.fullPath}`);
				}

				carmodsLines[vehicleName] = {
					line,
					fullPath: fileObj.fullPath,
				};
			});

			//update vehicles tag
			VehicleUpdate.carmods();
		}
		async function checkFileVehAudio(fileObj) {
			await waitFileObjLoad(fileObj);

			if (fastman92AudioFile != null) {
				console.error("there are 2 fastman files:\n"+fastman92AudioFile+"\n"+fileObj.fullPath);
				return;
			}
			fastman92AudioFile = fileObj.fullPath;
			if (vehicleAudioRX.test(fileObj.text) != true) {
				console.error("corrupt fastman92 vehicle audio file");
				return;
			}

			fileObj.text.match(vehicleAudioRX).forEach(line => {
				let vehicleName = line.split(" ")[0].split("\t")[0];

				if (vehicleAudio[vehicleName] != null) {
					console.warn(`AUDIO: replacing ${vehicleName}.\n${fileObj.fullPath}`);
				}

				vehicleAudio[vehicleName] = line;
			});

			//update vehicles tag
			VehicleUpdate.audio();
		}
		
		
		function updateVehicleData() {

			//check for dff and txd existance
			vehiclesList.forEach(veh => {
				const vehicleFileName = veh.name.toLowerCase();
				let txdname = veh.lines.ide.split(vehicleIdeRx)[3].trim().toLowerCase();
				if (txdname.endsWith(",")) txdname = txdname.slice(0, -1).trim();
				const filesWithVehicleName = Object.values(files).filter(fileObj => fileObj.name.toLowerCase().startsWith(vehicleFileName) || fileObj.name.toLowerCase().startsWith(txdname));

				let dffLocation = filesWithVehicleName.find(fileObj => fileObj.name.toLowerCase() == vehicleFileName+".dff");
				if (dffLocation != null) {
					veh.filePaths.dff = dffLocation.fullPath;
				} else if (!veh.isDefault && !veh.isDisabled) {
					console.log("no dff vehicle: "+veh.id+" "+veh.name);
					summary.MissingDFF.push(veh.id);
				}

				let txdLocation = filesWithVehicleName.find(fileObj => fileObj.name.toLowerCase() == txdname+".txd");
				if (txdLocation != null) {
					veh.filePaths.txd = txdLocation.fullPath;
				} else if (!veh.isDefault && !veh.isDisabled) {
					console.log("no txd vehicle: "+veh.id+" "+veh.name);
					summary.MissingTXD.push(veh.id);
				}
			});

			//update vehicles summary
			vehiclesList.forEach(veh => {
				//missing dff/txd
				if (!veh.isDefault) {
					if (veh.filePaths.dff == null) veh.summary.errors.push("Missing DFF");
					if (veh.filePaths.txd == null) veh.summary.errors.push("Missing TXD");
				}

				//missing handling
				if (veh.filePaths.handling == null) {
					veh.summary.errors.push("Missing Handling");
					summary.MissingHandling.push(veh.id);
				}

				//missing audio
				if (fastman92AudioFile != null && veh.lines.audio == null) veh.summary.warnings.push("Missing Audio");
			});
		}
		async function updateFilesToIdList() {
			let loadedFilesCount = Object.keys(files).length;
			while (loadedFilesCount < fileCount) {
				folderUpload.textContent = "Loaded "+loadedFilesCount+" out of "+fileCount+" files.";
				await new Promise((res) => setTimeout(res, 250));
				loadedFilesCount = Object.keys(files).length;
			}
			if (loadedFilesCount !== fileCount) return;

			let readingFilesCount = Object.values(files).filter(x => x.text instanceof Promise).length;
			while (readingFilesCount > 0) {
				folderUpload.textContent = "Reading "+readingFilesCount+" file(s)";
				await Object.values(files).find(x => x.text instanceof Promise).text;
				readingFilesCount = Object.values(files).filter(x => x.text instanceof Promise).length;
			}
			if (readingFilesCount > 0) return;

			folderUpload.textContent = "All files are loaded.";
			await new Promise((res) => setTimeout(res, 1));
			folderUpload.classList.remove("active");
			idTable.innerHTML = `
				<tr>
					<th id="listed-vehicles">${vehiclesList.length}</th>
					<th>id</th>
					<th>type</th>
					<th>name</th>
					<th>game name</th>
					<th>class</th>
					<th>Audio</th>
					<th>Colors</th>
					<th>Tuning</th>
					<th>Handing</th>
					<th>Cost</th>
					<th>3D view</th>
				</tr>
			`;

			let wholeTable = ``;
			updateVehicleData();
			vehiclesList.forEach(veh => {
				let id = veh.id;
				let idName = veh.name;

				let vehicleSummary = {
					icon: iconsHTML.minus,
					details: "Normal Vehicle",
					color: "",
				};
				if (veh.summary.errors.length > 0) {
					vehicleSummary = {
						icon: iconsHTML.error,
						color: "rgb(200,100,100)",
						details: veh.summary.errors.join("\n"),
					};
				} else if (veh.summary.warnings.length > 0) {
					vehicleSummary = {
						icon: iconsHTML.error,
						color: "rgb(200,200,100)",
						details: veh.summary.warnings.join("\n"),
					};
				}

				let cost = veh.lines.handling.split(handlingRx).at(-7);
				veh.cost = cost;
				let sellCut = 0.03;
				if (veh.vehicleClass == "executive") sellCut = 0.1;
				else if (veh.vehicleClass == "richfamily") sellCut = 0.05;

				let tabelElement = `
					<tr>
						<td class="center" title="${vehicleSummary.details}" style="color: ${vehicleSummary.color};">${vehicleSummary.icon}</td>
						<td class="center ${veh.isDisabled ? "missing" : ""}" title="${veh.filePaths.ide}\n${veh.lines.ide}" copy="${id}">${id}</td>
						<td copy="${veh.lines.ide}">${vehicleTypeIcons[veh.type]} ${veh.type}</td>
						<td copy="${idName}">${idName}</td>
						<td class="${veh.gameName == null ? "missing" : ""}" title="${veh.fxtTag}\n${veh.filePaths.fxt}" copy="${veh.fxtTag}">${veh.gameName || veh.name.toUpperCase()}</td>
						<td copy="${veh.vehicleClass}">${veh.vehicleClass}</td>
						<td copy="${veh.lines.audio}" class="center ${veh.lines.audio == null ? "missing" : ""}">${veh.lines.audio ? iconsHTML.check : iconsHTML.cross}</td>
						<td copy="${veh.lines.carcols}" class="center ${veh.lines.carcols == null ? "missing" : ""}" title="${veh.filePaths.carcols}\n${veh.lines.carcols}">${veh.lines.carcols ? iconsHTML.check : iconsHTML.cross}</td>
						<td copy="${veh.lines.carmods}" class="center ${veh.lines.carmods == null ? "missing" : ""}" title="${veh.filePaths.carmods}\n${veh.lines.carmods}">${veh.lines.carmods ? iconsHTML.check : iconsHTML.cross}</td>
						<td copy="${veh.lines.handling}" class="center ${veh.lines.handling == null ? "missing" : ""}" title="${veh.filePaths.handling}\n${veh.lines.handling}">${veh.lines.handling ? iconsHTML.check : iconsHTML.cross}</td>
						<td copy="${cost}" class="center" title="ownership: ${cost/2}\nsell: ${cost*sellCut}">$${cost}</td>
						<td vehmodel="${idName}" class="center ${veh.filePaths.dff == null ? "missing" : ""}" style="cursor: pointer;">${veh.filePaths.dff == null ? "Unavailable" : "View"}</td>
					</tr>
				`;
				wholeTable += tabelElement;
				// idTable.innerHTML += tabelElement;
				// updateIdStatus();
			});

			console.log("Loaded Data.");
			idTable.innerHTML += wholeTable;
			
			DataDirPath = "sa/data";
			ModelsDirPath = "sa/models";
			TexturesDirPath = "sa/textures";
			TxdDirPath = "sa/txd";
			fetchModelTXD("vehviewer/sa/textures/vehicle.txd", function(vehTxd) {
				globalTxd = vehTxd;
				let colortable = document.getElementById('def-colors');
				removeChildren(colortable);

				for(let i = 0; i < VehicleColours.length; i += 8){
					let tr = document.createElement('tr');
					for(let j = 0; j < 8 && (i+j) < VehicleColours.length; j++){
						let td = document.createElement('td');
						td.width = "16px";
						td.height = "16px";
						let col = VehicleColours[i + j];
						col.push(255);
						td.style = "background-color: rgb("+col[0]+","+col[1]+","+col[2]+")";
						td.onclick = function(ev) {
							carColors[0] = col;
							carColors[2] = col;
							setVehicleColors(modelinfo, carColors[0], carColors[1], carColors[2], carColors[3]);
						};
						td.oncontextmenu = function(ev) {
							carColors[1] = col;
							carColors[3] = col;
							ev.preventDefault();
							setVehicleColors(modelinfo, carColors[0], carColors[1], carColors[2], carColors[3]);
						};
						tr.appendChild(td);
					}
					colortable.appendChild(tr);
				}
				try {
					SelectModel(vehiclesList.find(x => x.isDisabled == false && x.filePaths.dff?.length > 0 && x.summary.errors.length == 0)?.name);
				} catch {}
			});
			// loadVehicleViewer("vehicles.ide", function() {
			// });
			
			//3d view
			idTable.querySelectorAll("[vehmodel]").forEach(element => {
				let text = element.getAttribute("vehmodel");
				if ((text || "") == "" || text == "undefined") return;
				
				element.addEventListener("click", () => {
					document.querySelectorAll(".selected[vehmodel]")
						.forEach(e => e.classList.remove("selected"));
					element.classList.add("selected");
					SelectModel(text);
				});
			});

			//click to copy field
			idTable.querySelectorAll("[copy]").forEach(element => {
				let text = element.getAttribute("copy");
				if ((text || "") == "" || text == "undefined") return;
				
				element.addEventListener("click", () => {
					copyContent(text);
				});
			});

			updateIdStatus();
		}

		function updateIdStatus() {
			const enabledVeh = vehiclesList.filter(x => !x.isDisabled);

			
			let VehiclesWithTuning = enabledVeh.filter(x => 
				x.lines.carmods?.replace(/,/g, " ").slice(x.name.length).trim()
				.replace(/stereo/g, "")
				.replace(/nto_b_[^ \n]+/g, "").trim()
			);
			window.VehiclesWithTuning = VehiclesWithTuning;

			idStatus.innerHTML = `
			In-Game Vehicles: ${enabledVeh.length}
			Custom Vehicles: ${enabledVeh.filter(x => !x.isDefault).length}
			Disabled Vehicles: ${vehiclesList.filter(x => x.isDisabled).length}
			Total Vehicles: ${vehiclesList.length}
			Vehicles with tuning: ${VehiclesWithTuning.length}
			Vehicles without color: ${enabledVeh.filter(x => !x.lines.carcols).length} (includes uncolorable vehicles)
			Vehicles without audio: ${enabledVeh.filter(x => !x.lines.audio).length}
			Vehicles without handling: ${enabledVeh.filter(x => !x.lines.handling).length}
			Handling Count: ${Object.keys(handlingTags).length}
			`.trim().replace(/\n/gm, "<br>");

			updateSummary();
		}
		function updateSummary() {
			const errorHeader = document.getElementById("summary-errors-count");
			const errorSection = document.getElementById("summary-errors");

			summary.ExtraAudio = Object.keys(vehicleAudio).filter(x => vehiclesList.find(veh => veh.name == x && !veh.isDisabled) == null);
			summary.ExtraCarCols = Object.keys(carcolsLines).filter(x => vehiclesList.find(veh => veh.name == x) == null);
			summary.ExtraCarMods = Object.keys(carmodsLines).filter(x => vehiclesList.find(veh => veh.name == x) == null);


			let errorLength = 0;
			errorLength += summary.MissingDFF.length;
			errorLength += summary.MissingTXD.length;
			errorLength += summary.MissingHandling.length;
			errorLength += summary.ExtraAudio.length;
			errorLength += summary.ExtraCarCols.length;
			errorLength += summary.ExtraCarMods.length;

			if (errorLength == 0) {
				errorHeader.textContent = "No Errors";
				errorHeader.style.color = "#ddd";
				errorSection.textContent = "No Errors Found.";
				return;
			} else {
				errorHeader.textContent = errorLength+" Errors";
				errorHeader.style.color = "";
				errorSection.innerHTML = "";
			}

			if (summary.MissingDFF.length > 0) errorSection.innerHTML += `<b>${summary.MissingDFF.length} Missing DFF:</b> ${summary.MissingDFF.join(", ")}<br>`;
			if (summary.MissingTXD.length > 0) errorSection.innerHTML += `<b>${summary.MissingTXD.length} Missing TXD:</b> ${summary.MissingTXD.join(", ")}<br>`;
			if (summary.MissingHandling.length > 0) errorSection.innerHTML += `<b>${summary.MissingHandling.length} Missing Handling:</b> ${summary.MissingHandling.join(", ")}<br>`;
			if (summary.ExtraAudio.length > 0) errorSection.innerHTML += `<b>${summary.ExtraAudio.length} Unused Vehicle Audio:</b> ${summary.ExtraAudio.join(", ")}<br>`;
			if (summary.ExtraCarCols.length > 0) errorSection.innerHTML += `<b>${summary.ExtraCarCols.length} Unused CarCols:</b> ${summary.ExtraCarCols.map(x => `<span title="${carcolsLines[x].fullPath}">${x}</span>`).join(", ")}<br>`;
			if (summary.ExtraCarMods.length > 0) errorSection.innerHTML += `<b>${summary.ExtraCarMods.length} Unused CarCols:</b> ${summary.ExtraCarMods.map(x => `<span title="${carmodsLines[x].fullPath}">${x}</span>`).join(", ")}<br>`;
		}
		function viewer3DNext(isBack) {
			let next = 1;
			if (isBack == true) next = -1;

			let currentModel = document.querySelector(".selected[vehmodel]")?.getAttribute("vehmodel");
			if (currentModel == null) return;
			let currentIndex = vehiclesList.findIndex(x => x.name == currentModel);
			if (currentIndex == -1) return;
			
			let nextModel = vehiclesList[currentIndex+next];
			while (nextModel != null && !isVehicleVisible(nextModel)) {
				currentIndex += next;
				nextModel = vehiclesList[currentIndex+next];
			}
			if (nextModel == null) return;
			document.querySelectorAll(".selected[vehmodel]")
				.forEach(e => e.classList.remove("selected"));
			document.querySelector('[vehmodel="'+nextModel.name+'"]')?.classList.add("selected");
			SelectModel(nextModel.name);
		}




		const initilizedActions = {
			cheatmenu: false,
			vehiclestest: false,
			modifyids: false,
			modifynames: false,
			vehiclesepartor: false,
			vehicleorgenizer: false,
		}
		function generateCheatMenu() {
			const popup = document.getElementById("cheatmenu-popup");
			if (initilizedActions.cheatmenu) return popup.classList.add("active");
			initilizedActions.cheatmenu = true;

			const textBox = document.getElementById("cheatmenu-vehicles");
			const enabledCustomVeh = vehiclesList.filter(x => !x.isDisabled && !x.isDefault);
			const usedNames = [];

			if (enabledCustomVeh.length == 0) {
				alert("No custom vehicles detected.");
				return;
			}

			// prompt("Copy and paste in `CheatMenuSA\\data\\vehicles.toml`", "[Custom]\n"+
			// enabledCustomVeh.map((veh, vehi) => {
			// 		let vehicleName = (veh.gameName || veh.name.toUpperCase()).replace(/'/g, "");

			// 		while (usedNames.includes(vehicleName)) {
			// 			vehicleName = vehicleName + " ";
			// 		}
			// 		usedNames.push(vehicleName);

			// 		return `'${vehicleName}' = '${veh.id}'`;
			// 	}).join("\n"),
			// );
			textBox.value = "[Custom]\n"+
			enabledCustomVeh.map((veh, vehi) => {
					let vehicleName = (veh.gameName || veh.name.toUpperCase()).replace(/'/g, "");

					while (usedNames.includes(vehicleName)) {
						vehicleName = vehicleName + " ";
					}
					usedNames.push(vehicleName);

					return `'${vehicleName}' = '${veh.id}'`;
				}).join("\n");

			popup.classList.add("active");
		}
		function generateVehiclesTest() {
			const popup = document.getElementById("vehiclestest-popup");
			if (initilizedActions.vehiclestest) return popup.classList.add("active");
			initilizedActions.vehiclestest = true;

			const textBox = document.getElementById("vehiclestest-vehicles");
			const enabledCustomVeh = vehiclesList.filter(x => !x.isDisabled && !x.isDefault);
			let lowestId = Infinity;
			let highestId = 0;
			let unavailableIds = [];

			if (enabledCustomVeh.length == 0) {
				alert("No custom vehicles detected.");
				return;
			}

			//get highest and lowest ids
			enabledCustomVeh.forEach((veh, vehi) => {
				if (veh.id > highestId) highestId = veh.id;
				if (veh.id < lowestId) lowestId = veh.id;
			});

			//search from lows to highs and list unavailable ids
			for (let idIndex = lowestId; idIndex <= highestId; idIndex++) {
				if (enabledCustomVeh.find(x => x.id == idIndex) != null) continue;

				unavailableIds.push(idIndex);
			}

			// prompt(`Copy and paste in 'cleo\\Vehicles Test.ini'\nStart At: ${lowestId}\nEnd At: ${highestId}\nTotal: ${unavailableIds.length}`, 
			// 	unavailableIds.map((id, index) => `ID${index+1} = ${id}`).join("\n")
			// );
			textBox.value = `AddedIDstart = ${lowestId}\nAddedIDend = ${highestId}\n\n[Ignore]\nTotal = ${unavailableIds.length}\n` + unavailableIds.map((id, index) => `ID${index+1} = ${id}`).join("\n")
			popup.classList.add("active");
		}
		function modifyVehiclesIds() {
			const popup = document.getElementById("modifyids-popup");
			if (initilizedActions.modifyids) return popup.classList.add("active");
			initilizedActions.modifyids = true;

			const startIndex = document.getElementById("modifyids-startindex");
			const skipExistingIdsInput = document.getElementById("modifyids-skipexistingids");
			const textBox = document.getElementById("modifyids-vehicles");

			const updateList = () => {
				let index = parseInt(startIndex.value);
				let skipUsed = skipExistingIdsInput.checked;
				textBox.value = textBox.value.replace(vehicleIdeRx, (line, id) => {
					let isDisabled = false;
					if (line.startsWith("#")) isDisabled = true;

					while (skipUsed && //allows skipping
						(idList.find(x => x.id == index) != null || // skip used ids
						vehiclesList.find(x => x.id == index) != null) // skip disabled ids
					) {
						index--;
					}
					index--;

					return (isDisabled ? "#" : "") + (index+1) + line.slice(isDisabled + id.length)
				});
			};

			startIndex.addEventListener("input", updateList);
			skipExistingIdsInput.addEventListener("input", updateList);
			textBox.addEventListener("change", updateList);

			popup.classList.add("active");
		}
		function modifyVehiclesName() {
			const popup = document.getElementById("modifynames-popup");
			if (initilizedActions.modifynames) return popup.classList.add("active");
			initilizedActions.modifynames = true;

			const fromRx = document.getElementById("modifynames-from");
			const toRx = document.getElementById("modifynames-to");
			const updateBtn = document.getElementById("modifynames-update");
			const textBox = document.getElementById("modifynames-vehicles");

			updateBtn.addEventListener("click", () => {
				let rgx = RegExp(fromRx.value, "gm");
				// textBox.value = textBox.value.replace(rgx, toRx.value);
				textBox.value = textBox.value.replace(vehicleIdeRx, (line) => {
					if (!line.includes(",")) return;
					const splittenLine = line.split(",");

					let dffname = splittenLine[1].trim();
					let txdname = splittenLine[2].trim();
					if (dffname.endsWith(",")) dffname = dffname.slice(0, -1).trim();
					if (txdname.endsWith(",")) txdname = txdname.slice(0, -1).trim();

					dffname = dffname.replace(rgx, toRx.value);
					txdname = txdname.replace(rgx, toRx.value);

					return splittenLine[0] + ", " + dffname + ",\t" + txdname + "," + splittenLine.slice(3).join(",");
					// return `${id}, ${dffname.replace(rgx, toRx.value)},\t${txdname.replace(rgx, toRx.value)},` + line.split(",").slice(3).join(",");
				});
				textBox.value = textBox.value.replace(carcolsRX, (line) => {

					let vehicleName = line.split(" ")[0].split("\t")[0].split(",")[0].trim();
					if (vehicleName == "DK22Pac") return line;

					if (vehicleName.endsWith(",")) vehicleName = vehicleName.slice(0, -1).trim();
					const vehNameLength = vehicleName.length;
					vehicleName = vehicleName.replace(rgx, toRx.value);

					return vehicleName + line.trim().slice(vehNameLength);
				});
				textBox.value = textBox.value.replace(carmodsRX, (line) => {

					let vehicleName = line.split(" ")[0].split("\t")[0].split(",")[0].trim;

					if (vehicleName.endsWith(",")) vehicleName = vehicleName.slice(0, -1).trim();
					const vehNameLength = vehicleName.length;
					vehicleName = vehicleName.replace(rgx, toRx.value);

					return vehicleName + line.trim().slice(vehNameLength);
				});
				textBox.value = textBox.value.replace(vehicleAudioRX, (line) => {

					let vehicleName = line.split(" ")[0].split("\t")[0].trim();

					const vehNameLength = vehicleName.length;
					vehicleName = vehicleName.replace(rgx, toRx.value);

					return vehicleName + line.trim().slice(vehNameLength);
				});

			});

			popup.classList.add("active");
		}
		function vehiclesSeparator() {
			const popup = document.getElementById("vehiclesepartor-popup");
			if (initilizedActions.vehiclesepartor) return popup.classList.add("active");
			initilizedActions.vehiclesepartor = true;

			const updateBtn = document.getElementById("vehiclesepartor-update");
			const allVehicles = document.getElementById("vehiclesepartor-vehicles");
			const existingVeh = document.getElementById("vehiclesepartor-existing");

			updateBtn.addEventListener("click", () => {
				existingVeh.value = "";
				let conflictLines = [];
				let duplicateLines = [];
				allVehicles.value = allVehicles.value.replace(vehicleIdeRx, (line, ...vehicleDetails) => {

					let vehicleId = parseInt(vehicleDetails[0]);
					let vehicleName = vehicleDetails[1];
					if (vehicleName.endsWith(",")) vehicleName = vehicleName.slice(0, -1);

					//conflict
					let registeredVehicle = vehiclesList.find(veh =>
						(veh.id == vehicleId && veh.name != vehicleName) || //id conflict
						(veh.id != vehicleId && veh.name == vehicleName) 	//same model twice
					);
					if (registeredVehicle) {
						conflictLines.push(line);
						return "";
					}

					//already exists (same id and same name)
					if (vehiclesList.find(veh => veh.id == vehicleId) != null) {
						duplicateLines.push(line);
						return "";
					}

					return line;
				});
				conflictLines.push("");
				allVehicles.value = allVehicles.value.replace(carcolsRX, (line) => {

					let vehicleName = line.split(" ")[0].split("\t")[0].split(",")[0];
					if (vehicleName == "DK22Pac") return line;

					if (carcolsLines[vehicleName] != null && carcolsLines[vehicleName].line.trim() == line.trim()) {
						duplicateLines.push(line);
						return "";
					}
					if (carcolsLines[vehicleName] != null && carcolsLines[vehicleName].line.trim() !== line.trim()) {
						conflictLines.push(line);
						return "";
					}

					return line;
				});
				conflictLines.push("");
				allVehicles.value = allVehicles.value.replace(carmodsRX, (line) => {

					let vehicleName = line.split(" ")[0].split("\t")[0].split(",")[0];

					if (carmodsLines[vehicleName] != null &&
						carmodsLines[vehicleName].line.trim() == line.trim()
					) {
						duplicateLines.push(line);
						return "";
					}
					if (carmodsLines[vehicleName] != null &&
						carmodsLines[vehicleName].line.trim() != line.trim()
					) {
						conflictLines.push(line);
						return "";
					}

					return line;
				});
				conflictLines.push("");
				allVehicles.value = allVehicles.value.replace(handlingRx, (line) => {

					let tag = line.split(" ")[0].split("\t")[0];

					if (handlingTags[tag] != null && handlingTags[tag].line.trim() == line.trim()) {
						duplicateLines.push(line);
						return "";
					}
					if (handlingTags[tag] != null && handlingTags[tag].line.trim() !== line.trim()) {
						conflictLines.push(line);
						return "";
					}

					return line;
				});
				conflictLines.push("");
				allVehicles.value = allVehicles.value.replace(fxtFormatRX, (line) => {

					let tag = line.split(" ")[0];
					let text = line.split(" ").slice(1).join(" ").trim();

					if (fxtTags[tag] != null) {
						conflictLines.push(line);
						return "";
					}

					return line;
				});
				conflictLines.push("");
				allVehicles.value = allVehicles.value.replace(vehicleAudioRX, (line) => {

					let vehicleName = line.split(" ")[0].split("\t")[0];

					if (vehicleAudio[vehicleName] != null && vehicleAudio[vehicleName].trim() == line.trim()) {
						duplicateLines.push(line);
						return "";
					}
					if (vehicleAudio[vehicleName] != null && vehicleAudio[vehicleName].trim() !== line.trim()) {
						conflictLines.push(line);
						return "";
					}

					return line;
				});

				existingVeh.value = "\n\n# Conflicts\n\n"+conflictLines.join("\n")+"\n\n\n\n# Duplicates\n\n"+duplicateLines.join("\n");
			});

			popup.classList.add("active");
		}
		function vehiclesOrgenizer() {
			const popup = document.getElementById("vehicleorgenizer-popup");
			if (initilizedActions.vehicleorgenizer) return popup.classList.add("active");
			initilizedActions.vehicleorgenizer = true;

			const updateBtn = document.getElementById("vehicleorgenizer-update");
			const allVehicles = document.getElementById("vehicleorgenizer-vehicles");
			const existingVeh = document.getElementById("vehicleorgenizer-existing");

			updateBtn.addEventListener("click", () => {
				existingVeh.value = "";
				let existingLines = {
					ide: [],
					carcols: [],
					carmods: [],
					handling: [],
					audio: [],
					fxt: [],
				};
				allVehicles.value = allVehicles.value.replace(vehicleIdeRx, (line) => {
					existingLines.ide.push(line);
					return "";
				});
				allVehicles.value = allVehicles.value.replace(carcolsRX, (line) => {
					existingLines.carcols.push(line);
					return "";
				});
				allVehicles.value = allVehicles.value.replace(carmodsRX, (line) => {
					existingLines.carmods.push(line);
					return "";
				});
				allVehicles.value = allVehicles.value.replace(handlingRx, (line) => {
					existingLines.handling.push(line);
					return "";
				});
				allVehicles.value = allVehicles.value.replace(vehicleAudioRX, (line) => {
					existingLines.audio.push(line);
					return "";
				});
				allVehicles.value = allVehicles.value.replace(fxtFormatRX, (line) => {
					existingLines.fxt.push(line);
					return "";
				});

				if (existingLines.ide.length > 0) {
					existingVeh.value += `\n\n\n####################\n#   Vehciles.ide   #\n####################\n\n`;
					existingVeh.value += existingLines.ide.join("\n")+"\n";
				}
				if (existingLines.carcols.length > 0) {
					existingVeh.value += `\n\n\n###################\n#   CarCols.dat   #\n###################\n\n`;
					existingVeh.value += existingLines.carcols.join("\n")+"\n";
				}
				if (existingLines.carmods.length > 0) {
					existingVeh.value += `\n\n\n###################\n#   CarMods.dat   #\n###################\n\n`;
					existingVeh.value += existingLines.carmods.join("\n")+"\n";
				}
				if (existingLines.handling.length > 0) {
					existingVeh.value += `\n\n\n####################\n#   Handling.cfg   #\n####################\n\n`;
					existingVeh.value += existingLines.handling.join("\n")+"\n";
				}
				if (existingLines.audio.length > 0) {
					existingVeh.value += `\n\n\n###################\n#  Vehcile Audio  #\n###################\n\n`;
					existingVeh.value += existingLines.audio.join("\n")+"\n";
				}
				if (existingLines.fxt.length > 0) {
					existingVeh.value += `\n\n\n###################\n#       FXT       #\n###################\n\n`;
					existingVeh.value += existingLines.fxt.join("\n")+"\n";
				}
			});

			popup.classList.add("active");
		}
		
		function updateSearch() {
			updateVisibleList();
		}
		function updateVisibleList() {
			if (!(searchbox instanceof HTMLInputElement)) return;

			// const text = searchbox.value.toLowerCase();
			// const hasTextSearch = text.length > 0;
			// const isTextNumber = !isNaN(parseInt(text)) && (parseInt(text)+"") == text;
			let allVehicles = idTable.querySelectorAll("tbody:nth-child(2) > tr");

			const vehiclesCountElement = document.getElementById("listed-vehicles");
			let showingVehiclesCount = 0;

			allVehicles.forEach((vehElement, vehIndex) => {
				const veh = vehiclesList[vehIndex];

				let isShowing = isVehicleVisible(veh);

				//display vehicle
				if (isShowing) { vehElement.classList.remove("hidden"); showingVehiclesCount++; }
				else vehElement.classList.add("hidden");
			});

			if (vehiclesCountElement) vehiclesCountElement.textContent = showingVehiclesCount;
		}
		function isVehicleVisible(veh) {
			const text = searchbox.value.toLowerCase();
			const hasTextSearch = text.length > 0;
			const isTextNumber = !isNaN(parseInt(text)) && (parseInt(text)+"") == text;
			let isShowing = true;

			if (hasTextSearch) {

				//name search
				if (!veh.gameName?.toLowerCase().includes(text) && !veh.name.toLowerCase().includes(text)) {
					// check for id search
					if (isTextNumber) {
						if (!(veh.id+"").startsWith(text)) isShowing = false;
					} else isShowing = false;
				}

			}

			//apply filters
			if (isShowing && filters.VehEnabled != 1) {
				if (filters.VehEnabled == 0 && veh.isDisabled) isShowing = false;
				else if (filters.VehEnabled == 2 && !veh.isDisabled) isShowing = false;
			}
			if (isShowing && filters.SummaryType != 2) {
				if (filters.SummaryType == 0 && veh.summary.errors.length == 0) isShowing = false;
				if (filters.SummaryType == 1 && veh.summary.warnings.length == 0) isShowing = false;
			}
			if (isShowing && filters.CustomVeh != 1) {
				if (filters.CustomVeh == 0 && veh.isDefault) isShowing = false;
				else if (filters.CustomVeh == 2 && !veh.isDefault) isShowing = false;
			}
			if (isShowing && filters.Tuning != 1) {
				let hasTuning = (veh.lines.carmods?.replace(/,/g, " ").slice(veh.name.length).trim()
					.replace(/stereo/g, "")
					.replace(/nto_b_[^ \n]+/g, "").trim() || "") != "";
				if (filters.Tuning == 0 && !hasTuning) isShowing = false;
				else if (filters.Tuning == 2 && veh.lines.carmods != null) isShowing = false;
			}
			if (isShowing && filters.Audio != 1) {
				if (filters.Audio == 0 && veh.lines.audio == null) isShowing = false;
				else if (filters.Audio == 2 && veh.lines.audio != null) isShowing = false;
			}
			if (isShowing && filters.HasColors != 1) {
				if (filters.HasColors == 0 && veh.lines.carcols == null) isShowing = false;
				else if (filters.HasColors == 2 && veh.lines.carcols != null) isShowing = false;
			}
			if (isShowing && filters.HasHandling != 1) {
				if (filters.HasHandling == 0 && veh.lines.handling == null) isShowing = false;
				else if (filters.HasHandling == 2 && veh.lines.handling != null) isShowing = false;
			}
			if (isShowing && filters.VehType != "any") {
				if (filters.VehType != veh.type) isShowing = false;
			}
			if (isShowing && filters.ClassType != "any") {
				if (filters.ClassType != veh.vehicleClass) isShowing = false;
			}

			return isShowing;
		}




		//https://www.freecodecamp.org/news/copy-text-to-clipboard-javascript/
		async function copyContent(text) {
			try {
				await navigator.clipboard.writeText(text);
				console.log('Content copied to clipboard');
				/* Resolved - text copied to clipboard successfully */
			} catch (err) {
				console.error('Failed to copy: ', err);
				/* Rejected - text failed to copy to the clipboard */
			}
		}
	</script>
</body>
</html>